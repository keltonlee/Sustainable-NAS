wandb: Currently logged in as: felixhtlee (asgc). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.0
wandb: Run data is saved locally in /dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/wandb/run-20240603_022626-ezw2u9za
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run MCUNet-A-supernet_1.0_32-seed123
wandb: ‚≠êÔ∏è View project at https://wandb.ai/asgc/CIFAR10-MCUNET-A-evo-search_01
wandb: üöÄ View run at https://wandb.ai/asgc/CIFAR10-MCUNET-A-evo-search_01/runs/ezw2u9za
ARG_IMPORT_SETTINGS : /dicos_ui_home/felixlee/tmp/NAS/Sustainable_NAS/TiNAS/settings/MCUNet-A.json,/dicos_ui_home/felixlee/tmp/NAS/Sustainable_NAS/TiNAS/settings/CIFAR10.json
{'GLOBAL_SETTINGS': {'EXP_SUFFIX': 'MCUNet-A-threshold-0.1'},
 'NAS_EVOSEARCH_SETTINGS': {'EVOSEARCH_SCORE_TYPE': 'ACC'},
 'NAS_SSOPTIMIZER_SETTINGS': {'SSOPT_CONSTRAINTS': 'CHK_PASS_STORAGE,CHK_PASS_SPATIAL,CHK_PASS_ATOMICITY,CHK_PASS_RESPONSIVENESS',
                              'SSOPT_POLICY': 'FLOPS',
                              'VALID_SUBNETS_THRESHOLD': 0.1},
 'PLATFORM_SETTINGS': {'IMC_CONSTRAINT': 0}}
{'NAS_EVOSEARCH_SETTINGS': {'FIXED_NUM_CPU_WORKERS': 4,
                            'GENERATIONS': 15,
                            'POP_SIZE': 8},
 'NAS_SETTINGS_GENERAL': {'DATASET': 'CIFAR10'},
 'NAS_SSOPTIMIZER_SETTINGS': {'SUBNET_SAMPLE_SIZE': 1000},
 'TINAS': {'STAGE1_SETTINGS': {'DROPPING_BLOCK_LEVEL': {'MOBILENET_NUM_LAYERS_EXPLICIT': [1],
                                                        'SUPPORT_SKIP': [False]},
                               'DROPPING_NET_LEVEL': {'INPUT_RESOLUTION': [28],
                                                      'WIDTH_MULTIPLIER': [0.2,
                                                                           0.3,
                                                                           0.4,
                                                                           0.5]}},
           'STAGE2_SETTINGS': {'BEST_STABLE_GENERATIONS': 5}}}
ARG_IMPORT_SETTINGS_JSON : '{}'
ARG_SET_GPUIDS :  0
ARG_SET_DATASET :  CIFAR10
ARG_SET_SEED :  123
ARG_SET_SUFFIX :  MCUNet-A-supernet_1.0_32-seed123
ARG_SET_CCAP :  0.005
ARG_SET_LATREQ :  419.396478810978
ARG_SET_LATREQ :  0.0
ARG_STAGES :  3
ARG_TRAINED_SUPERNET_FNAME :  MCUNet-A-CIFAR10-supernet_1.0_32_supernet_mnas_best.pth
ARG_NO_RLOGGER :  False
ARG_RLOGGER_PROJ_NAME :  CIFAR10-MCUNET-A-evo-search_01
Updated settings:
GLOBAL_SETTINGS:=
{'EXP_SUFFIX': 'MCUNet-A-supernet_1.0_32-seed123',
 'REMOTE_LOGGER_EXTRA_TAGS': [],
 'REMOTE_LOGGER_GROUP_NAME_SUFFIX': '',
 'REMOTE_LOGGER_RUN_NAME_SUFFIX': '',
 'RLOGGER_PROJECT_NAME': 'CIFAR10-MCUNET-A-evo-search_01',
 'USE_REMOTE_LOGGER': True}
CUDA_SETTINGS:=
{'GPUIDS': '0'}
PLATFORM_SETTINGS:=
{'CCAP': 0.005,
 'CPU_CLOCK': 16000000,
 'DATA_SZ': 2,
 'EAV_SAFE_MARGIN': 0.6,
 'IMC_CONSTRAINT': 0.0,
 'LAT_E2E_REQ': 419.396478810978,
 'MCU_TYPE': 'MSP430',
 'NVM_CAPACITY': 1000000,
 'NVM_CAPACITY_ALLOCATION': [1000000, 1000000],
 'POW_TYPE': 'CONT',
 'REHM': 2800,
 'REHM_TABLE': {'0.0001': 3100, '0.00047': 3000, '0.005': 2800},
 'VM_CAPACITY': 2048,
 'VOFF': 3.29,
 'VON': 4.535,
 'VSUP': 5.892}
NAS_SETTINGS_GENERAL:=
{'CHECKPOINT_DIR': '/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/checkpoints/',
 'DATASET': 'CIFAR10',
 'MODEL_FN_TYPE': 'MODEL_FN_CONV2D',
 'SEED': 123,
 'STAGES': '3',
 'TRAIN_BATCHNORM_EPSILON': 1e-05,
 'TRAIN_OPT_MOM': 0.9,
 'TRAIN_OPT_WD': 5e-05,
 'TRAIN_PRINT_FREQ': 100}
NAS_SSOPTIMIZER_SETTINGS:=
{'DO_RESAMPLING': False,
 'SSOPT_CONSTRAINTS': 'CHK_PASS_STORAGE,CHK_PASS_SPATIAL,CHK_PASS_ATOMICITY,CHK_PASS_RESPONSIVENESS',
 'SSOPT_POLICY': 'FLOPS',
 'SSOPT_RESULTS_FNAME': '/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/train_log/MCUNet-A-supernet_1.0_32-seed123_ssoptlog.json',
 'SSOPT_TRAINED_SUPERNET_FNAME': '/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/train_log/MCUNet-A-supernet_1.0_32-seed123_trsupnetresults.json',
 'SUBNET_SAMPLE_SIZE': 1000,
 'VALID_SUBNETS_THRESHOLD': 0.1}
NAS_EVOSEARCH_SETTINGS:=
{'DEBUG_ENABLED': False,
 'EVOSEARCH_BYPASS_EFFICIENCY': False,
 'EVOSEARCH_ENABLE_EVOMEMORY': False,
 'EVOSEARCH_INITIAL_POPULATION_FNAME': None,
 'EVOSEARCH_LOGFNAME': '/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/train_log/MCUNet-A-supernet_1.0_32-seed123_evosearchlog.json',
 'EVOSEARCH_SCORE_TYPE': 'ACC',
 'EVOSEARCH_TRIALS': 1,
 'FIXED_NUM_CPU_WORKERS': 4,
 'GENERATIONS': 15,
 'MUT_PROB': 0.05,
 'MUT_RATIO': 0.5,
 'PARENT_RATIO': 0.2,
 'POP_SIZE': 8}
TINAS:=
{'STAGE1_SETTINGS': {'DROPPING_BLOCK_LEVEL': {'EXP_FACTORS': [],
                                              'KERNEL_SIZES': [],
                                              'MOBILENET_NUM_LAYERS_EXPLICIT': [1],
                                              'SUPPORT_SKIP': [False]},
                     'DROPPING_ENABLED': False,
                     'DROPPING_NET_LEVEL': {'INPUT_RESOLUTION': [28],
                                            'WIDTH_MULTIPLIER': [0.2,
                                                                 0.3,
                                                                 0.4,
                                                                 0.5]}},
 'STAGE2_SETTINGS': {'BEST_STABLE_GENERATIONS': 5,
                     'BLOCK_SEARCH_SPACE': 'default',
                     'MUTATION_OPERATOR': 'mutate_default',
                     'MUT_PROB_PER_BLOCK': [0.05, 0.05, 0.05, 0.05],
                     'MUT_PROB_PER_BLOCK_EXPLOITATION': [0.05,
                                                         0.05,
                                                         0.05,
                                                         0.05],
                     'MUT_PROB_PER_BLOCK_EXPLORATION': [0.2, 0.05, 0.05, 0.05]}}
NAS_SETTINGS_PER_DATASET:=
{'CIFAR10': {'DOWNSAMPLE_BLOCKS': [0, 1, 2, 3],
             'EXP_FACTORS': [1, 3, 4, 6],
             'FINETUNE_BATCHSIZE': 100,
             'FINETUNE_OPT_LR': 0.025,
             'FINETUNE_SUBNET_EPOCHS': 20,
             'FIRST_BLOCK_HARD_CODED': False,
             'INPUT_CHANNELS': 3,
             'INPUT_RESOLUTION': [32, 28],
             'KERNEL_SIZES': [1, 3, 5, 7],
             'MOBILENET_NUM_LAYERS_EXPLICIT': [1, 2, 3],
             'NUM_BLOCKS': 4,
             'NUM_CLASSES': 10,
             'OUT_CH_PER_BLK': [16, 24, 32, 64, 96, 160, 320],
             'STEM_C_OUT': 16,
             'STRIDE_FIRST': 2,
             'SUPPORT_SKIP': [False, True],
             'TRAIN_DATADIR': '/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/dataset/CIFAR10/',
             'TRAIN_OPT_LR': 0.025,
             'TRAIN_SUBNET_BATCHSIZE': 100,
             'TRAIN_SUBNET_EPOCHS': 20,
             'TRAIN_SUPERNET_BATCHSIZE': 256,
             'TRAIN_SUPERNET_EPOCHS': 400,
             'USE_1D_CONV': False,
             'VAL_BATCHSIZE': 500,
             'WIDTH_MULTIPLIER': [0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]},
 'HAR': {'DOWNSAMPLE_BLOCKS': [0, 1, 2],
         'EXP_FACTORS': [1, 3, 4, 6],
         'FINETUNE_BATCHSIZE': 64,
         'FINETUNE_OPT_LR': 0.05,
         'FINETUNE_SUBNET_EPOCHS': 15,
         'FIRST_BLOCK_HARD_CODED': False,
         'INPUT_CHANNELS': 9,
         'INPUT_RESOLUTION': [64, 128],
         'KERNEL_SIZES': [1, 3, 5, 7],
         'MOBILENET_NUM_LAYERS_EXPLICIT': [1, 2, 3],
         'NUM_BLOCKS': 3,
         'NUM_CLASSES': 6,
         'OUT_CH_PER_BLK': [8, 12, 16, 32, 48, 80, 160],
         'STEM_C_OUT': 10,
         'STRIDE_FIRST': 2,
         'SUPPORT_SKIP': [False, True],
         'TRAIN_OPT_LR': 0.025,
         'TRAIN_SUBNET_BATCHSIZE': 64,
         'TRAIN_SUPERNET_BATCHSIZE': 64,
         'TRAIN_SUPERNET_EPOCHS': 200,
         'USE_1D_CONV': True,
         'VAL_BATCHSIZE': 64,
         'WIDTH_MULTIPLIER': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]},
 'KWS': {'DOWNSAMPLE_BLOCKS': [0, 1, 2],
         'EXP_FACTORS': [1, 3],
         'FINETUNE_SUBNET_EPOCHS': 30,
         'FIRST_BLOCK_HARD_CODED': False,
         'INPUT_CHANNELS': 1,
         'INPUT_RESOLUTION': [125, 250],
         'KERNEL_SIZES': [1, 3],
         'MOBILENET_NUM_LAYERS_EXPLICIT': [1, 2],
         'NUM_BLOCKS': 3,
         'NUM_CLASSES': 12,
         'OUT_CH_PER_BLK': [4, 8, 16, 32, 64, 128, 256],
         'STEM_C_OUT': 10,
         'STRIDE_FIRST': 2,
         'SUPPORT_SKIP': [False, True],
         'TRAIN_OPT_LR': 0.05,
         'TRAIN_SUBNET_BATCHSIZE': 64,
         'TRAIN_SUPERNET_BATCHSIZE': 64,
         'TRAIN_SUPERNET_EPOCHS': 200,
         'USE_1D_CONV': True,
         'VAL_BATCHSIZE': 64,
         'WIDTH_MULTIPLIER': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}}
DUMPER_SETTINGS:=
{'DUMP_DIR': ''}
LOG_SETTINGS:=
{'LOG_LEVEL': 1,
 'REMOTE_LOGGING_SYNC_DIR': '/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/wandb_dir/',
 'TRAIN_LOG_DIR': '/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/train_log/',
 'TRAIN_LOG_FNAME': 'train_info.csv'}
NAS_TESTING_SETTINGS:=
{'FINETUNE_BASE_GENERATION': None,
 'TRAINED_SUPERNET_FNAME': 'MCUNet-A-CIFAR10-supernet_1.0_32_supernet_mnas_best.pth'}

create_supernet::Enter
Using supernet config [1.0, 32]
--------------
/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/train_log/MCUNet-A-supernet_1.0_32-seed123_ssoptlog.json
[1.0, 32]
/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/checkpoints/MCUNet-A-CIFAR10-supernet_1.0_32_supernet_mnas_best.pth
--------------
-- stage_evo_search::Enter
Supernet net_choices: (1.0, 32)
EvoMem:: ENABLE =  False
Generate random population...
init population : latency
_mpworker_pop_efficiency::Enter [2], num_jobs=2
time: 176.2274854183197 seconds
time: 125.41866850852966 seconds
_mpworker_pop_efficiency::Enter [0], num_jobs=2
time: 185.1855390071869 seconds
time: 206.78083610534668 seconds
init population : accuracy
batched_child_pool [[[[3, 5, 1, False], [4, 5, 3, True], [4, 1, 2, True], [3, 7, 3, True]]], [[[3, 3, 2, True], [4, 7, 1, False], [6, 5, 3, False], [6, 7, 3, False]]], [[[3, 1, 1, False], [6, 7, 2, False], [6, 3, 3, True], [1, 7, 3, True]]], [[[6, 7, 3, False], [6, 1, 1, False], [6, 5, 2, False], [3, 5, 1, True]]], [[[6, 5, 1, False], [6, 7, 2, False], [3, 7, 1, False], [3, 1, 1, True]]], [[[1, 1, 1, False], [6, 3, 2, False], [4, 7, 3, True], [1, 7, 1, False]]], [[[3, 7, 3, False], [3, 5, 3, False], [1, 7, 3, False], [4, 7, 3, False]]], [[[6, 3, 3, True], [6, 5, 3, False], [4, 5, 2, False], [3, 5, 2, False]]]]
Traceback (most recent call last):
  File "/cvmfs/cvmfs.grid.sinica.edu.tw/twgrid/anaconda/CentOS7/4.12.0/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/cvmfs.grid.sinica.edu.tw/twgrid/anaconda/CentOS7/4.12.0/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/run_nas.py", line 260, in <module>
    main()
  File "/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/run_nas.py", line 256, in main
    run_nas(test_settings)
  File "/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/run_nas.py", line 242, in run_nas
    stage_evo_search(global_settings, dataset, best_supernet, stage_evo_search_logfname)
  File "/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/run_nas.py", line 153, in stage_evo_search
    best_solution = evo_search(global_settings, dataset, best_supernet, stage_evo_search_logfname, run_id=run_id, exp_suffix=f'{exp_suffix}-{run_id}')
  File "/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/evo_search/CF_search.py", line 94, in evo_search
    best_valids, best_info = finder.run_evolution_search(verbose=True)
  File "/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/evo_search/CF_evolution_finder.py", line 669, in run_evolution_search
    population = self.init_population(verbose)
  File "/dicos_ui_home/felixlee.bak/tmp/NAS/Sustainable_NAS/TiNAS/NASBase/evo_search/CF_evolution_finder.py", line 629, in init_population
    population.append([accs[pix], child_pool[pix], efficiency_pool[pix], carbon_pool[pix], imc_pool[pix]])
IndexError: list index out of range
wandb: - 0.006 MB of 0.006 MB uploadedwandb: \ 0.006 MB of 0.036 MB uploadedwandb: | 0.036 MB of 0.036 MB uploadedwandb: üöÄ View run MCUNet-A-supernet_1.0_32-seed123 at: https://wandb.ai/asgc/CIFAR10-MCUNET-A-evo-search_01/runs/ezw2u9za
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/asgc/CIFAR10-MCUNET-A-evo-search_01
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240603_022626-ezw2u9za/logs
Number of unique subnets in the initial population: 0
